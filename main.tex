% ************************************************************************
% ************************************************************************
% ************************************************************************
%
% MAIN
%
% ************************************************************************
% ************************************************************************
% ************************************************************************

% *************************************************************************
% *************************************************************************
%
% BEGIN SECTION
%
% *************************************************************************
% *************************************************************************

% ************************************************************************
% ************************************************************************
% ************************************************************************
%
% SECTION: BLOCK DIAGRAMS
%
% ************************************************************************
% ************************************************************************
% ************************************************************************

\section{Block Diagrams}%\label{sec:}


% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE
%
% ************************************************************************


\setlength{\unitlength}{.09in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		%
		% REFERENCE COMMAND
		%
		
		\put(-3,7){$r$}                                             % r
		\put(-4,4){\shortstack{\tiny{reference}\\ \tiny{command}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(2,5){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,3){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(13,10.5){$d_i$}                          % di
		\put(15,10){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,3){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(27,10.5){$d_o$}                          % do
		\put(29,10){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,4){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(28,-1){\line(-1,0){27.5}}                % Leftward Feedback Vector Out of n Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,-5.5){\vector(0,1){4}}              % Upward Arrow Into n Summer
		\put(30,-2.5){$n$}                            % n
		\put(29,-4.5){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label
		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		\vspace*{0.6in}
		\caption{Standard negative feedback structure}
		\label{fig:classical_fb}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE -- WITH PRE-FILTER
%
% ************************************************************************


\setlength{\unitlength}{.09in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		
		%
		% REFERENCE COMMAND
		%		
		\put(-12,7){$r$}                                             % r
		\put(-13.5,4){\shortstack{\tiny{reference}\\ \tiny{command}}}  % reference command label
		\put(-13,6){\vector(1,0){4}}                                 % Right Arrow Into W

		%
		% PRE-FILTER
		%
		\put(-9,4){\framebox(5,4){$W$}}                % W
		\put(-9,3){\tiny{Pre-Filter}}                  % Pre-filter Label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into summer		
		\put(-2,7){$\hat{r}$}                                             % \hat{r}
		

		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(2,5){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,3){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(13,10.5){$d_i$}                          % di
		\put(15,10){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,3){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(27,10.5){$d_o$}                          % do
		\put(29,10){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,4){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(28,-1){\line(-1,0){27.5}}                % Leftward Feedback Vector Out of n Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,-5.5){\vector(0,1){4}}              % Upward Arrow Into n Summer
		\put(30,-2.5){$n$}                            % n
		\put(29,-4.5){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label
		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		\vspace*{0.6in}
		\caption{Standard negative feedback structure -- with pre-filter}
		\label{fig:classical_fb_w_W}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE -- WITH SENSOR
%
% ************************************************************************


\setlength{\unitlength}{.09in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		%
		% REFERENCE COMMAND
		%
		
		\put(-3,7){$r$}                                             % r
		\put(-4,4){\shortstack{\tiny{reference}\\ \tiny{command}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(2,5){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,3){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(13,10.5){$d_i$}                          % di
		\put(15,10){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,3){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(27,10.5){$d_o$}                          % do
		\put(29,10){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,4){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
	
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,-5.5){\vector(0,1){4}}              % Upward Arrow Into n Summer
		\put(30,-2.5){$n$}                            % n
		\put(29,-4.5){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label

		%
		% SENSOR
		%
		\put(28,-1){\vector(-1,0){8}}                % Leftward Feedback Vector Out of n Summer into H
		\put(21,-2.5){$y + n$}                           % y + n
		\put(15,-3){\framebox(5,4){$H$}}               % H
		\put(15.5,-5){\shortstack{\tiny{{Sensor}} \\ \tiny{{Dynamics}}}}                % Sensor Label
		\put(13,-2.5){$\hat{y}$}                             % \hat{y}

		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(15,-1){\line(-1,0){14.5}}                % Leftward Feedback Vector Out of H Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal

		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		\vspace*{0.6in}
		\caption{Standard negative feedback structure -- with sensor}
		\label{fig:classical_fb_w_H}
	\end{center}
\end{figure}



% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE -- WITH PRE-FILTER AND SENSOR
%
% ************************************************************************


\setlength{\unitlength}{.09in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize

		%
		% REFERENCE COMMAND
		%		
		\put(-12,7){$r$}                                             % r
		\put(-13.5,4){\shortstack{\tiny{reference}\\ \tiny{command}}}  % reference command label
		\put(-13,6){\vector(1,0){4}}                                 % Right Arrow Into W

		%
		% PRE-FILTER
		%
		\put(-9,4){\framebox(5,4){$W$}}                % W
		\put(-9,3){\tiny{Pre-Filter}}                  % Pre-filter Label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into summer
		\put(-2,7){$\hat{r}$}                                             % \hat{r}
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(2,5){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,3){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(13,10.5){$d_i$}                          % di
		\put(15,10){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,3){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(27,10.5){$d_o$}                          % do
		\put(29,10){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,4){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
	
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,-5.5){\vector(0,1){4}}              % Upward Arrow Into n Summer
		\put(30,-2.5){$n$}                            % n
		\put(29,-4.5){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label

		%
		% SENSOR
		%
		\put(28,-1){\vector(-1,0){8}}                % Leftward Feedback Vector Out of n Summer into H
		\put(21,-2.5){$y + n$}                           % y + n
		\put(15,-3){\framebox(5,4){$H$}}               % H
		\put(15.5,-5){\shortstack{\tiny{{Sensor}} \\ \tiny{{Dynamics}}}}                % Sensor Label
		\put(13,-2.5){$\hat{y}$}                             % \hat{y}

		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(15,-1){\line(-1,0){14.5}}                % Leftward Feedback Vector Out of H Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal

		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		\vspace*{0.6in}
		\caption{Standard negative feedback structure -- with pre-filter and sensor}
		\label{fig:classical_fb_w_W_H}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE -- SMALL
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		%
		% REFERENCE COMMAND
		%
		
		\put(-3,7){$r$}                                             % r
		\put(-3,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(1.75,9){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(12.5,10){$d_i$}                          % di
		\put(15,9){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(26.5,10){$d_o$}                          % do
		\put(29,9){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(28,-1){\line(-1,0){27.5}}                % Leftward Feedback Vector Out of n Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,-5.5){\vector(0,1){4}}              % Upward Arrow Into n Summer
		\put(30,-2.5){$n$}                            % n
		\put(29,-5){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label
		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		\vspace*{0.4in}
		\caption{Standard negative feedback structure -- small}
		\label{fig:classical_fb_small}
	\end{center}
\end{figure}



% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE -- SMALL -- BEAMER
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		%
		% REFERENCE COMMAND
		%
		
		\put(-3,7){$r$}                                             % r
		\put(-5,3){\shortstack{\tiny{reference}\\ \tiny{command}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(2,5){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,3){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(13,10){$d_i$}                          % di
		\put(15,9){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,3){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(26.5,10){$d_o$}                          % do
		\put(29,9){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(28,-1){\line(-1,0){27.5}}                % Leftward Feedback Vector Out of n Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,-5.5){\vector(0,1){4}}              % Upward Arrow Into n Summer
		\put(30,-2.5){$n$}                            % n
		\put(29,-5){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label
		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		\vspace*{0.4in}
		\caption{Standard negative feedback structure -- small -- beamer}
		\label{fig:classical_fb_small_beamer}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE -- SMALL -- WITH NOISE INSIDE FEEDBACK LOOP
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		%
		% REFERENCE COMMAND
		%
		
		\put(-3,7){$r$}                                             % r
		\put(-3,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(1.75,9){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(12.5,10){$d_i$}                          % di
		\put(15,9){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(26.5,10){$d_o$}                          % do
		\put(29,9){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(28,-1){\line(-1,0){27.5}}                % Leftward Feedback Vector Out of n Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,3.5){\vector(0,-1){4}}              % Upward Arrow Into n Summer
		\put(29,2){$n$}                            % n
		\put(24,-0.25){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label
		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		\vspace*{0.4in}
		\caption{Standard negative feedback structure -- small -- with noise inside loop}
		\label{fig:classical_fb_small}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE -- SMALL -- WITH PRE-FILTER
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		
		%
		% REFERENCE COMMAND
		%
		
		\put(-2.5,7){$\hat{r}$}                                             % \hat{r}
		%\put(-3,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% REFERENCE COMMAND
		%		
		\put(-12,7){$r$}                                             % r
		\put(-12.5,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-13,6){\vector(1,0){4}}                                 % Right Arrow Into W

		%
		% PRE-FILTER
		%
		\put(-9,4){\framebox(5,4){$W$}}                % W
		\put(-9,2.5){\tiny{Pre-Filter}}                  % Pre-filter Label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into summer		
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(1.75,9){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(12.5,10){$d_i$}                          % di
		\put(15,9){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(26.5,10){$d_o$}                          % do
		\put(29,9){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(28,-1){\line(-1,0){27.5}}                % Leftward Feedback Vector Out of n Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,3.5){\vector(0,-1){4}}              % Upward Arrow Into n Summer
		\put(29,2){$n$}                            % n
		\put(24,-0.25){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label
		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		\vspace*{0.4in}
		\caption{Standard negative feedback structure -- small -- with pre-filter}
		\label{fig:classical_fb_small_w_W}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE -- SMALL -- WITH SENSOR
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		%
		% REFERENCE COMMAND
		%
		
		\put(-3,7){$r$}                                             % r
		\put(-3,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(1.75,9){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(12.5,10){$d_i$}                          % di
		\put(15,9){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(26.5,10){$d_o$}                          % do
		\put(29,9){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,3.5){\vector(0,-1){4}}              % Upward Arrow Into n Summer
		\put(29,2){$n$}                            % n
		\put(24,-0.25){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label
		

		%
		% SENSOR
		%
		\put(28,-1){\vector(-1,0){8}}                % Leftward Feedback Vector Out of n Summer into H
		\put(21,-2.5){$y + n$}                           % y + n
		\put(15,-3){\framebox(5,4){$H$}}               % H
		\put(12.5,1.25){\tiny{Sensor Dyn}}                % Sensor Label
		\put(12,-2.5){$\hat{y}$}                             % \hat{y}

		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(15,-1){\line(-1,0){14.5}}                % Leftward Feedback Vector Out of H Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		
		\end{picture}
		\vspace*{0.4in}
		\caption{Standard negative feedback structure -- small -- with sensor}
		\label{fig:classical_fb_small_w_H}
	\end{center}
\end{figure}




% ************************************************************************
%
% FIGURE: STANDARD P-K FEEDBACK STRUCTURE -- SMALL -- WITH SENSOR AND PRE-FILTER
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize

		%
		% REFERENCE COMMAND
		%
		
		\put(-2.5,7){$\hat{r}$}                                             % \hat{r}
		%\put(-3,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% REFERENCE COMMAND
		%		
		\put(-12,7){$r$}                                             % r
		\put(-12.5,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-13,6){\vector(1,0){4}}                                 % Right Arrow Into W

		%
		% PRE-FILTER
		%
		\put(-9,4){\framebox(5,4){$W$}}                % W
		\put(-9,2.5){\tiny{Pre-Filter}}                  % Pre-filter Label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into summer		
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$e$}                              % e
		\put(1.75,9){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(12.5,10){$d_i$}                          % di
		\put(15,9){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(26.5,10){$d_o$}                          % do
		\put(29,9){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% SENSOR NOISE
		%
		\put(28.5,-1){\circle{1}}                     % n summer
		\put(28.5,3.5){\vector(0,-1){4}}              % Upward Arrow Into n Summer
		\put(29,2){$n$}                            % n
		\put(24,-0.25){\shortstack{\tiny{sensor}\\\tiny{noise}}}     % sensor noise label
		

		%
		% SENSOR
		%
		\put(28,-1){\vector(-1,0){8}}                % Leftward Feedback Vector Out of n Summer into H
		\put(21,-2.5){$y + n$}                           % y + n
		\put(15,-3){\framebox(5,4){$H$}}               % H
		\put(12.5,1.25){\tiny{Sensor Dyn}}                % Sensor Label
		\put(12,-2.5){$\hat{y}$}                             % \hat{y}

		%
		% FEEDBACK
		%
		\put(31,6){\line(0,-1){7}}                    % Downward Line From y
		\put(31,-1){\vector(-1,0){2}}                 % Leftward Arrow Into n Summer
		\put(15,-1){\line(-1,0){14.5}}                % Leftward Feedback Vector Out of H Summer
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		
		\end{picture}
		\vspace*{0.4in}
		\caption{Standard negative feedback structure -- small -- with pre-filter and sensor}
		\label{fig:classical_fb_small_w_W_H}
	\end{center}
\end{figure}



% ************************************************************************
%
% FIGURE: GAIN MARGIN
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		%
		% REFERENCE COMMAND
		%
		
		\put(-3,7){$r$}                                             % r
		%\put(-3,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% GAIN
		%
		\put(1,6){\vector(1,0){5}}                    % Rightward Arrow Into K
		\put(3,7){$e$}                              % e
		%\put(1.75,9){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(6,4){\framebox(5,4){$k$}}                % k
		%\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(11,6){\vector(1,0){5}}                   % Right Arrow Out of K Into di Summer
		%\put(11.5,7){$u$}                             % u
		%\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		
		%
		% LOOP
		%
		%\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		%\put(16,7){$u_p$}                             % up
		\put(16,4){\framebox(5,4){$L$}}               % L
		%\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(21,6){\vector(1,0){7}}                   % Arrow Out of P Into do Summer
		%\put(25.5,7){$y_p$}                           % yp
		
		
		%
		% OUTPUT
		%
		%\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(26,7){$y$}                                             % y
		%\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% FEEDBACK
		%
		\put(26,6){\line(0,-1){7}}                    % Downward Line From y
		\put(26,-1){\line(-1,0){25.5}}              % Leftward Feedback Vector 
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal

		
		\end{picture}
		\vspace*{0.4in}
		\caption{Gain margin loop}
		%\label{fig:}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: PHASE MARGIN
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		%
		% REFERENCE COMMAND
		%
		
		\put(-3,7){$r$}                                             % r
		%\put(-3,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% GAIN
		%
		\put(1,6){\vector(1,0){5}}                    % Rightward Arrow Into K
		\put(3,7){$e$}                              % e
		%\put(1.75,9){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(6,4){\framebox(7,4){\small $e^{-j PM}$}}                % e^{-j PM}
		%\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(13,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		%\put(11.5,7){$u$}                             % u
		%\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		
		%
		% LOOP
		%
		%\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		%\put(16,7){$u_p$}                             % up
		\put(17,4){\framebox(5,4){$L$}}               % L
		%\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(22,6){\vector(1,0){6}}                   % Arrow Out of P Into do Summer
		%\put(25.5,7){$y_p$}                           % yp
		
		
		%
		% OUTPUT
		%
		%\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(26,7){$y$}                                             % y
		%\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% FEEDBACK
		%
		\put(26,6){\line(0,-1){7}}                    % Downward Line From y
		\put(26,-1){\line(-1,0){25.5}}              % Leftward Feedback Vector 
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal

		
		\end{picture}
		\vspace*{0.4in}
		\caption{Phase margin loop}
		%\label{fig:}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: PHASE MARGIN
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		%
		% REFERENCE COMMAND
		%
		
		\put(-3,7){$r$}                                             % r
		%\put(-3,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W
		
		%
		% GAIN
		%
		\put(1,6){\vector(1,0){5}}                    % Rightward Arrow Into K
		\put(3,7){$e$}                              % e
		%\put(1.75,9){\shortstack{\tiny{error}}}          % error signal label
		
		
		\put(6,4){\framebox(5,4){\small $e^{-s \Delta}$}}                % e^{-s \Delta}
		%\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(11,6){\vector(1,0){5}}                   % Right Arrow Out of K Into di Summer
		%\put(11.5,7){$u$}                             % u
		%\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		
		%
		% LOOP
		%
		%\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		%\put(16,7){$u_p$}                             % up
		\put(16,4){\framebox(5,4){$L$}}               % L
		%\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(21,6){\vector(1,0){7}}                   % Arrow Out of P Into do Summer
		%\put(25.5,7){$y_p$}                           % yp
		
		
		%
		% OUTPUT
		%
		%\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(26,7){$y$}                                             % y
		%\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		
		%
		% FEEDBACK
		%
		\put(26,6){\line(0,-1){7}}                    % Downward Line From y
		\put(26,-1){\line(-1,0){25.5}}              % Leftward Feedback Vector 
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal

		
		\end{picture}
		\vspace*{0.4in}
		\caption{Delay margin loop}
		%\label{fig:}
	\end{center}
\end{figure}


\newpage
\FloatBarrier

% ************************************************************************
%
% FIGURE: OPEN-LOOP SYSTEM -- WITH DISTURBANCES
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$r$}                              % r
		\put(1.75,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){4}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into di Summer
		\put(12.5,10){$d_i$}                          % di
		\put(15,9){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		\put(25.5,7){$y_p$}                           % yp
		
		%
		% OUTPUT DISTURBANCE
		%
		\put(28.5,6){\circle{1}}                      % do summer
		\put(28.5,10.5){\vector(0,-1){4}}             % Downward Arrow Into do Summer
		\put(26.5,10){$d_o$}                          % do
		\put(29,9){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(32,7){$y$}                                             % y
		\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		

		
		\end{picture}
		\vspace*{0.4in}
		\caption{Open-loop system with disturbances}
		\label{fig:ols_w_dist}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: OPEN-LOOP SYSTEM -- WITH DISTURBANCES
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		
		%
		% INPUT
		%
		\put(0,6){\vector(1,0){5}}                    % Rightward Arrow Into H
		\put(1.5,7){$u$}                              % u
		
		%
		% SYSTEM
		%		
		\put(5,4){\framebox(5,4){$H$}}                % H
		\put(4,2.5){\tiny{LTI Stable}}                  % H Label
		\put(10,6){\vector(1,0){5}}                   % Right Arrow Out of H
		\put(11.5,7){$y$}                             % y
		
		\end{picture}
		\vspace*{0.4in}
		\caption{LTI system response to input}
		%\label{fig:}
	\end{center}
\end{figure}

% ************************************************************************
%
% FIGURE: OPEN-LOOP SYSTEM -- WITH DISTURBANCES
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$r$}                              % r
		\put(1.75,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){9}}                   % Right Arrow Out of K Into di Summer
		\put(14.5,7){$u$}                             % u
		\put(13.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		
		%
		% PLANT
		%
		\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		%\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P$}}               % P
		\put(20,2.5){\tiny{{Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){9}}                   % Arrow Out of P Into do Summer
		%\put(25.5,7){$y_p$}                           % yp
		
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(28,7){$y$}                                             % y
		\put(27.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		

		
		\end{picture}
		\vspace*{0.4in}
		\caption{Open-loop system without disturbances}
		\label{fig:ols_wo_dist}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: OPEN-LOOP SYSTEM -- WITH PLANT UNCERTAINTY
%
% ************************************************************************

\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(31,15)
		\footnotesize
		
		%
		% CONTROLLER
		%
		\put(1,6){\vector(1,0){4}}                    % Rightward Arrow Into K
		\put(2.5,7){$r$}                              % r
		\put(1.75,3){\shortstack{\tiny{ref}\\ \tiny{cmd}}}  % reference command label
		
		
		\put(5,4){\framebox(5,4){$K$}}                % K
		\put(5,2.5){\tiny{Controller}}                  % Controller Label
		\put(10,6){\vector(1,0){9}}                   % Right Arrow Out of K Into di Summer
		\put(11.5,7){$u$}                             % u
		\put(10.5,4.5){\shortstack{\tiny{control}}}     % control label
		
		
		%
		% INPUT DISTURBANCE
		%
		%\put(14.5,6){\circle{1}}                      % di Summer
		\put(14.5,12){\line(0,-1){6}}             % Upward Arrow toward \Delta
		%\put(12.5,10){$d_i$}                          % di
		%\put(15,9){\shortstack{\tiny{input}\\\tiny{disturbance}}}  % input disturbance label
		
		
		%
		% PLANT
		%
		%\put(15,6){\vector(1,0){4}}                   % Arrow Out of di Summer Into P
		%\put(16,7){$u_p$}                             % up
		\put(19,4){\framebox(5,4){$P_{0}$}}               % P
		\put(17.5,2.5){\tiny{{Nom Plant}}}                % Plant Label
		\put(24,6){\vector(1,0){4}}                   % Arrow Out of P Into do Summer
		%\put(25.5,7){$y_p$}                           % yp

		%
		% MODELING ERROR
		%
		\put(14.5,12){\vector(1,0){4.5}}                   % Arrow Out of di Summer Into P
		%\put(16,7){$u_p$}                             % up
		\put(19,10){\framebox(5,4){$\Delta$}}               % \Delta
		\put(17,8.75){\tiny{{Modeling Error}}}                % \Delta Label
		\put(24,12){\line(1,0){4.5}}                   % Arrow Out of \Delta Into Summer
		%\put(25.5,12){$y_p$}                           % yp

		\put(28.5,6){\circle{1}}                      %  summer
		\put(28.5,12){\vector(0,-1){5.5}}             % Downward Arrow Into  Summer
		%\put(26.5,10){$d_o$}                          % do
		%\put(29,9){\shortstack{\tiny{output}\\\tiny{disturbance}}} % output disturbance label
		
		%
		% OUTPUT
		%
		\put(29,6){\vector(1,0){4}}                                 % Arrow Out of do Summer Toward Output
		\put(30,7){$y$}                                             % y
		\put(29,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		

		
		\end{picture}
		\vspace*{0.4in}
		\caption{Open-loop system plant disturbances}
		\label{fig:ols_w_P_dist}
	\end{center}
\end{figure}









% *************************************************************************
%
% FIGURE: GENERALIZED PLANT
%
% *************************************************************************

\setlength{\unitlength}{.07in}


\begin{figure}[h]
	\begin{center}
		\begin{picture}(18,11)
		% ***********************
		%
		% G
		%	
		\put(1,8){\vector(1,0){5}}                          % Top Rightward Arrow Into G
		\put(1,8.5){$w$}                                    % w
		\put(6,2){\framebox(8,8){$G$}}                      % G
		\put(14,8){\vector(1,0){5}}                         % Top Rightward Arrow Out of G
		\put(18,8.5){$z$}                                   % z
		\put(1,4){\vector(1,0){5}}                           % Bottom Rightward Arrow Into G
		\put(14,4){\line(1,0){5}}                            % Bottom Rightward Arrow Out of G
		% ***********************
		%
		% K
		%	
		\put(19,4){\line(0,-1){7}}                     % Right Downward Arrow From G Toward K
		\put(18,4.5){$y$}                             % y
		\put(19,-3){\vector(-1,0){6}}                  % Leftward Arrow Into K
		\put(7,-5.5){\framebox(6,5){$K$}}               % K
		\put(1,4.5){$u$}                        % u
		\put(7,-3){\line(-1,0){6}}                     % Leftward Line Out Of  K
		\put(1,-3){\line(0,1){7}}                      % Upward Line From K Toward G	
		\end{picture}
		\vspace*{0.5in}
	\caption{CLS with generalized plant}
	\label{fig:gen_plant}
	\end{center}
\end{figure}



% ************************************************************************
%
% FIGURE: Hinfty MIXED SENSITIVITY BLOCK DIAGRAM
%
% ************************************************************************


\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(35.5,16.5)
		\footnotesize
		
		% ***********************
		%
		% REFERENCE COMMAND
		%	
		
		\put(-3,7){$w$}                                             % r
		\put(-6.5,3){\shortstack{\tiny{reference}\\ \tiny{command}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W

		% ***********************
		%
		% ERROR (MEASUREMENTS y)
		%
		
		\put(1,6){\vector(1,0){6}}                    % Rightward Arrow Into K
		\put(2.5,12){$y$}                              % y
		\put(4.5,12){\shortstack{\tiny{measurements}}}          % error signal label

		% ***********************
		%
		% \hat{z}_1, W_1, z_1
		%

		\put(4,6){\line(0,1){10}}             			% Upward vector towards W_1
		\put(4,16){\vector(1,0){25}}         			% Rightward vector into W_1
		\put(25.5,17){$\hat{z}_{1}$}                     % \hat{z}_1
		\put(29,14){\framebox(5,4){$W_{1}$}}             % W_{1}
		\put(34,16){\vector(1,0){5}}                     % Arrow out of W_1 to z_1
		\put(35.5,17){$z_{1}$}                          	% z_1
		

		% ***********************
		%
		% CONTROLLER
		%
		
		\put(7,4){\framebox(5,4){$K$}}                % K
		\put(7,2.5){\tiny{Controller}}                  % Controller Label
		\put(12,6){\vector(1,0){6}}                   % Right Arrow Out of K Into P
		\put(13.5,9){$u$}                             % u
		\put(15.5,9){\shortstack{\tiny{control}}}     % control label
		
		% ***********************
		%
		% \hat{z}_2, W_2, z_2
		%

		\put(15,6){\line(0,1){5}}             			% Upward vector towards W_2
		\put(15,11){\vector(1,0){14}}         			% Rightward vector into W_2
		\put(25.5,12){$\hat{z}_{2}$}                     % \hat{z}_2
		\put(29,9){\framebox(5,4){$W_{2}$}}             % W_{2}
		\put(34,11){\vector(1,0){5}}                     % Arrow out of W_2 to z_2
		\put(35.5,12){$z_{2}$}                          	% z_2

		
		% ***********************
		%
		% PLANT
		%

		\put(18,4){\framebox(5,4){$P$}}               % P
		\put(19,2.5){\tiny{{Plant}}}                % Plant Label
		\put(23,6){\vector(1,0){6}}                                 % Arrow Out of P Toward W_3

		
		% ***********************
		%
		% \hat{z}_3, W_3, z_3
		%
		
		\put(25.5,7){$\hat{z}_{3}$}                                    % \hat{z}_3
		%\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		\put(29,4){\framebox(5,4){$W_{3}$}}               % W_{3}
		\put(34,6){\vector(1,0){5}}                                 % Arrow Out of W_3 to z_3
		\put(35.5,7){$z_{3}$}                                    % z_3		
		
		% ***********************
		%
		% FEEDBACK
		%
		
		\put(26,6){\line(0,-1){7}}                    % Downward Line From y            
		\put(26,-1){\line(-1,0){25.5}}                % Leftward Feedback Vector
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		\vspace*{0.3in}
		\caption{Weighted $\Hinf$ mixed sensitivity block diagram}
		\label{fig:Hinfty_mixed_sen_block_diagram}
	\end{center}
\end{figure}


% ************************************************************************
%
% FIGURE: Hinfty MIXED SENSITIVITY BLOCK DIAGRAM -- BEAMER
%
% ************************************************************************


\setlength{\unitlength}{.06in}
\begin{figure}[h]
	\begin{center}
		\begin{picture}(35.5,16.5)
		\footnotesize
		
		% ***********************
		%
		% REFERENCE COMMAND
		%	
		
		\put(-3,7){$w$}                                             % r
		\put(-5,3){\shortstack{\tiny{reference}\\ \tiny{command}}}  % reference command label
		\put(-4,6){\vector(1,0){4}}                                 % Right Arrow Into W

		% ***********************
		%
		% ERROR (MEASUREMENTS y)
		%
		
		\put(1,6){\vector(1,0){6}}                    % Rightward Arrow Into K
		\put(2.5,7){$y$}                              % y
		\put(2,5){\shortstack{\tiny{measmts}}}          % error signal label

		% ***********************
		%
		% \hat{z}_1, W_1, z_1
		%

		\put(4,6){\line(0,1){10}}             			% Upward vector towards W_1
		\put(4,16){\vector(1,0){25}}         			% Rightward vector into W_1
		\put(25.5,17){$\hat{z}_{1}$}                     % \hat{z}_1
		\put(29,14){\framebox(5,4){$W_{1}$}}             % W_{1}
		\put(34,16){\vector(1,0){5}}                     % Arrow out of W_1 to z_1
		\put(35.5,17){$z_{1}$}                          	% z_1
		

		% ***********************
		%
		% CONTROLLER
		%
		
		\put(7,4){\framebox(5,4){$K$}}                % K
		\put(7,3){\tiny{Controller}}                  % Controller Label
		\put(12,6){\vector(1,0){6}}                   % Right Arrow Out of K Into P
		\put(13.5,7){$u$}                             % u
		\put(12.5,5){\shortstack{\tiny{control}}}     % control label
		
		% ***********************
		%
		% \hat{z}_2, W_2, z_2
		%

		\put(15,6){\line(0,1){5}}             			% Upward vector towards W_2
		\put(15,11){\vector(1,0){14}}         			% Rightward vector into W_2
		\put(25.5,12){$\hat{z}_{2}$}                     % \hat{z}_2
		\put(29,9){\framebox(5,4){$W_{2}$}}             % W_{2}
		\put(34,11){\vector(1,0){5}}                     % Arrow out of W_2 to z_2
		\put(35.5,12){$z_{2}$}                          	% z_2

		
		% ***********************
		%
		% PLANT
		%

		\put(18,4){\framebox(5,4){$P$}}               % P
		\put(19,3){\tiny{{Plant}}}                % Plant Label
		\put(23,6){\vector(1,0){6}}                                 % Arrow Out of P Toward W_3

		
		% ***********************
		%
		% \hat{z}_3, W_3, z_3
		%
		
		\put(25.5,7){$\hat{z}_{3}$}                                    % \hat{z}_3
		%\put(31.5,3){\shortstack{\tiny{actual}\\\tiny{output}}}       % actual output label
		\put(29,4){\framebox(5,4){$W_{3}$}}               % W_{3}
		\put(34,6){\vector(1,0){5}}                                 % Arrow Out of W_3 to z_3
		\put(35.5,7){$z_{3}$}                                    % z_3		
		
		% ***********************
		%
		% FEEDBACK
		%
		
		\put(26,6){\line(0,-1){7}}                    % Downward Line From y            
		\put(26,-1){\line(-1,0){25.5}}                % Leftward Feedback Vector
		\put(0.5,-1){\vector(0,1){6.5}}               % Upward Arrow Into Feedback Summer
		\put(1,4.5){$-$}                              % -
		\put(0.5,6){\circle{1}}                       % Summer at Error Signal
		
		
		%
		% Sensitivity and Complementary Sensitivity
		%
		%\put(0.5,-4.5){$S \defas [I+PK]^{-1}$}
		%\put(15,-4.5){$T \defas [I+PK]^{-1}PK$}
		
		
		\end{picture}
		%\vspace*{0.1in}
		\caption{Weighted $\Hinf$ mixed sensitivity block diagram -- beamer}
		\label{fig:Hinfty_mixed_sen_block_diagram}
	\end{center}
\end{figure}


% *************************************************************************
%
% FIGURE: INNER/OUTER FEEDBACK SYSTEM BLOCK DIAGRAM
%
% *************************************************************************

\setlength{\unitlength}{.1in}
\begin{figure}[htb!]
	\centering
		\begin{picture}(5,12)(-8,-3)
		\footnotesize
		%
		% Summer and Error Signal
		%
		\put(-27,6){\vector(1,0){4}}           % Rightward Arrow Into Error Summer
		\put(-26,7){$r$}                       % r
		\put(-22.5,6){\circle{1}}              % Summer at Error
		\put(-22,4.5){$-$}                     % -
		\put(-21,7){$e$}                       % e
		
		
		%
		% K_{out}
		%
		\put(-22,6){\vector(1,0){4}}           % Rightward Arrow into K(s)_outter
		\put(-18,4){\framebox(5,4){$K_{out}$}}      % K_{out}
		\put(-13,6){\vector(1,0){4}}           % Rightward Arrow out of K(s)_outter
		\put(-12,7){$u_{o}$}                    % u_o
		
		%
		% Plant input
		%
		\put(-3.5,6){\circle{1}}           % Summer at d_i Input
		\put(-3,6){\vector(1,0){4}}        % Rightward Arrow Into P(s)
		\put(-7,7){$u$}                    % u
		\put(-8.5,6){\circle{1}}           % Summer at Plant Input
		\put(-8,6){\vector(1,0){4}}        % Rightward Arrow Into d_i Summer
		\put(-3.5,10){\vector(0,-1){3.5}}       % Downward Line in d_i Summer
		\put(-3,8.8){$d_i$}                    % d_i
		\put(-2,7){$u_p$}                    % u_p
		
		%
		%  Noise
		%
		\put(4.5,-1){\circle{1}}           % Summer at n_i Input
		\put(4.5,2.5){\vector(0,-1){3}}       % Downward Line in n_i Summer
		\put(5,1.5){$n_i$}                    % n_i
		
		\put(10,-4){\circle{1}}           % Summer at n_o Input
		\put(10,0){\vector(0,-1){3.5}}       % Downward Line in n_o Summer
		\put(10.5,-1){$n_o$}                    % n_o
		
		%
		% Plant
		%
		\put(1,3.5){\framebox(5,5){$P$}}   % P
		\put(6,6.5){\vector(1,0){4}}                % Top line out of P
		\put(6,4.5){\line(1,0){3}}                % Bottom line out of P
		\put(6.5,7.5){$y_p$}                          % y_p
		\put(9,4.5){\line(0,-1){5.5}}            % Downward Line from xr toward Ki
		\put(7,3){$x_r$}                          % xr
		
		\put(11,6.5){\vector(1,0){4}}            % Rightward arrow Out of d_o summer
		\put(14,7.5){$y$}                        % y
		
		\put(10.5,6.5){\circle{1}}           % Summer at d_o
		\put(10.5,10){\vector(0,-1){3}}       % Downward Line in d_o Summer
		\put(11,8.8){$d_o$}                    % d_o
		
		%
		% Inner Loop
		%
		\put(9,-1){\vector(-1,0){4}}           % Leftward vector into ni(s)
		\put(4,-1){\vector(-1,0){4}}           % Leftward vector into Ki(s)
		
		\put(2,0){$e_i$}                      % e_i
		\put(-7,0){$u_i$}                      % u_i
		\put(-5,-3){\framebox(5,4){$K_{in}$}}        % K_{in}
		\put(-5,-1){\line(-1,0){3.5}}            % Leftward line out of K_{in}
		\put(-8.5,-1){\vector(0,1){6.5}}        % Upward vector into Summer at Plant Input
		\put(-8,4.5){$-$}                        % -
		
		%
		% Outer Loop Feedback
		%
		\put(13.5,6.5){\line(0,-1){10.5}}             % Downward Line from y
		\put(13.5,-4){\vector(-1,0){3}}         % Leftward feedback line into n_o
		\put(9.5,-4){\line(-1,0){32}}         % Leftward feedback line out of n_o
		\put(-22.5,-4){\vector(0,1){9.5}}     % Upward feedback line into e summer
		
		\end{picture}
		\caption{Hierarchical inner-outer loop feedback structure.}
		\label{fig:hierarchical_io_blockdiagram}
\end{figure} 


% *************************************************************************
%
% FIGURE: STANDARD FEEDBACK SYSTEM BLOCK DIAGRAM -- DONE PROGRAMMATICALLY
%
% *************************************************************************

\blockdiagramdimendefault

\xdef\xacc{0}
\xdef\yacc{0}

\setlength{\unitlength}{.1in}
\begin{figure}[htb!]
	\centering
		\begin{picture}(10,5)(10,-10)
		\footnotesize

		% ***********************
		%
		% r(t) -> e
		%
		
		% Arrow: r -> e summer
		\put(\xacc,\yacc){\vector(1,0){\bdarrowlength}}
		% Label: r
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$r$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdarrowlength}}
		
		% e summer
		\xdef\tmpx{\fpeval{\xacc+\bdcirclediameter/2}}	
		\put(\tmpx,\yacc){\circle{\bdcirclediameter}}
		% Coords: e summer
		\xdef\xesum{\tmpx}
		\xdef\yesum{\yacc}
		% Label: -
		\xdef\tmpx{\fpeval{\xacc+\bdcirclediameter}}
		\xdef\tmpy{\fpeval{\yacc-1.5}}
		\put(\tmpx,\tmpy){$-$}		
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdcirclediameter}}	

		% ***********************
		%
		% e -> K
		%
		
		% Arrow: e summer -> K
		\put(\xacc,\yacc){\vector(1,0){\bdarrowlength}}
		% Label: e
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$e$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdarrowlength}}	
		
		% Box: K
		\xdef\tmpy{\fpeval{\yacc-\bdboxheight/2}}
		\put(\xacc,\tmpy){\framebox(\bdboxwidth,\bdboxheight){$K$}}        	
		% Label: K
		\xdef\tmpx{\fpeval{\xacc}}
		\xdef\tmpy{\fpeval{\tmpy+\bdboxlabeloffsety}}
		\put(\tmpx,\tmpy){\tiny{Controller}}      
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdboxwidth}}

		% ***********************
		%
		% K -> d_i
		%
		
		% Arrow: K -> d_i summer
		\put(\xacc,\yacc){\vector(1,0){\bdarrowlength}}
		% Label: u
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$u$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdarrowlength}}		            
		
		% d_i summer
		\xdef\tmpx{\fpeval{\xacc+\bdcirclediameter/2}}	
		\put(\tmpx,\yacc){\circle{\bdcirclediameter}}
		% Coords: d_i summer
		\xdef\xdisum{\tmpx}
		\xdef\ydisum{\yacc}		
		% Arrow: d_i -> d_i summer
		\xdef\tmpy{\fpeval{\yacc+\bdarrowlength+\bdcirclediameter/2}}
		\put(\tmpx,\tmpy){\vector(0,-1){\bdarrowlength}}	
		% Label: d_i
		\xdef\tmpx{\fpeval{\tmpx+\bdvertlabeloffsetx}}
		\xdef\tmpy{\fpeval{\tmpy+\bdvertlabeloffsety}}
		\put(\tmpx,\tmpy){$d_{i}$}						
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdcirclediameter}}			

		% ***********************
		%
		% d_i -> P
		%

		% Arrow: d_i summer -> P
		\put(\xacc,\yacc){\vector(1,0){\bdarrowlength}}
		% Label: u_p
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$u_{p}$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdarrowlength}}

		% ***********************
		%
		% P
		%

		% Box: P
		\xdef\tmpy{\fpeval{\yacc-\bdboxheight/2}}
		\put(\xacc,\tmpy){\framebox(\bdboxwidth,\bdboxheight){$P$}}        			
		% Label: P
		\xdef\tmpx{\fpeval{\xacc}}
		\xdef\tmpy{\fpeval{\tmpy+\bdboxlabeloffsety}}
		\put(\tmpx,\tmpy){\tiny{Plant}}      
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdboxwidth}}

		% ***********************
		%
		% P -> d_o
		%

		% Arrow: P -> d_o summer
		\put(\xacc,\yacc){\vector(1,0){\bdarrowlength}}
		% Label: y_p
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$y_p$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdarrowlength}}		            
		
		% d_o summer
		\xdef\tmpx{\fpeval{\xacc+\bdcirclediameter/2}}	
		\put(\tmpx,\yacc){\circle{\bdcirclediameter}}
		% Coords: d_o summer
		\xdef\xdosum{\tmpx}
		\xdef\ydosum{\yacc}			
		% Arrow: d_o -> d_o summer
		\xdef\tmpy{\fpeval{\yacc+\bdarrowlength+\bdcirclediameter/2}}
		\put(\tmpx,\tmpy){\vector(0,-1){\bdarrowlength}}	
		% Label: d_o
		\xdef\tmpx{\fpeval{\tmpx+\bdvertlabeloffsetx}}
		\xdef\tmpy{\fpeval{\tmpy+\bdvertlabeloffsety}}
		\put(\tmpx,\tmpy){$d_{o}$}						
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdcirclediameter}}	

		% ***********************
		%
		% d_o -> y
		%

		% Arrow: d_o summer -> y
		\put(\xacc,\yacc){\vector(1,0){\bdarrowlength}}
		% Label: y
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$y$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdarrowlength}}
		
		% ***********************
		%
		% y
		%

		% Line: y -> downward portion of feedback path
		\xdef\tmpx{\fpeval{\xacc-\bdarrowlength/2}}				
		\put(\tmpx,\yacc){\line(0,-1){\feedbackpathheight}}
		% Update accumulators
		\xdef\xacc{\tmpx}		
		\xdef\yacc{\fpeval{\yacc - \feedbackpathheight}}

		% Line: downward portion of feedback path -> n summer
		\xdef\tmpx{\fpeval{abs(\xacc-\xdosum) - \bdcirclediameter/2}}				
		\put(\xacc,\yacc){\vector(-1,0){\tmpx}}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc-\tmpx}}		

		% n summer
		\xdef\tmpx{\fpeval{\xdosum}}	
		\put(\tmpx,\yacc){\circle{\bdcirclediameter}}	
		% Arrow: n -> n summer
		\xdef\tmpy{\fpeval{\yacc+\bdarrowlength+\bdcirclediameter/2}}
		\put(\tmpx,\tmpy){\vector(0,-1){\bdarrowlength}}	
		% Label: n
		\xdef\tmpx{\fpeval{\tmpx+\bdvertlabeloffsetx}}
		\xdef\tmpy{\fpeval{\tmpy+\bdvertlabeloffsety}}
		\put(\tmpx,\tmpy){$n$}	
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc-\bdcirclediameter}}		

		% Line: n summer -> feedback path below e summer
		\xdef\tmpx{\fpeval{abs(\xacc-\xesum)}}				
		\put(\xacc,\yacc){\line(-1,0){\tmpx}}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc-\tmpx}}

		% Arrow: feedback path below e summer -> e summer
		\xdef\tmpy{\fpeval{abs(\yacc-\yesum) - \bdcirclediameter/2}}				
		\put(\xacc,\yacc){\vector(0,1){\tmpy}}
		% Update accumulators
		\xdef\yacc{\fpeval{\yacc+\tmpy}}
		
		
		\end{picture}
		\caption{Standard negative feedback loop -- DONE PROGRAMMATICALLY.}
		%\label{fig:}
\end{figure} 


% *************************************************************************
%
% FIGURE: RCI BLOCK DIAGRAM
%
% *************************************************************************

\blockdiagramdimendefault

\xdef\bdboxwidth{8}
\xdef\bdboxheight{3}

\xdef\pathoffsety{0.75}
\xdef\uarrowlength{5}
\xdef\Pboxwidth{13}

\xdef\yarrowlength{5}
\xdef\yfblength{3}
\xdef\feedbackpathheight{8}

\xdef\xrfblength{1.5}
\xdef\xrfeedbackpathheight{5}

\xdef\backgroundborder{2.5}
\xdef\backgroundborderoverlap{1.5}

\xdef\xacc{0}
\xdef\yacc{0}

\xdef\tikzscale{0.254}
\setlength{\unitlength}{\tikzscale cm}
\begin{figure}[htb!]
	\centering
		\begin{tikzpicture}
		\footnotesize
		
		\pgftransformscale{\tikzscale}

		% ***********************
		%
		% r -> e
		%
		
		% Arrow: r -> e summer
		\xdef\yacc{\pathoffsety}
		\put(\xacc,\yacc){\vector(1,0){\bdarrowlength}}
		% Coords: r start
		\xdef\xrstart{\xacc}
		% Label: r
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$r$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdarrowlength}}
		
		% e summer
		\xdef\tmpx{\fpeval{\xacc+\bdcirclediameter/2}}	
		\put(\tmpx,\yacc){\circle{\bdcirclediameter}}
		% Coords: e summer
		\xdef\xesum{\tmpx}
		\xdef\yesum{\yacc}
		% Label: -
		\xdef\tmpx{\fpeval{\xacc+\bdcirclediameter}}
		\xdef\tmpy{\fpeval{\yacc-1.5}}
		\put(\tmpx,\tmpy){$-$}		
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdcirclediameter}}	

		% ***********************
		%
		% e -> K
		%
		
		% Arrow: e summer -> K
		\put(\xacc,\yacc){\vector(1,0){\bdarrowlength}}
		% Label: e
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$e$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdarrowlength}}	

		% ***********************
		%
		% K
		%
		
		% Box: K
		\xdef\tmpy{\fpeval{-\bdboxheight/2}}
		\draw (\xacc,\tmpy) 
			coordinate (KSW)
			rectangle ++(\bdboxwidth,\bdboxheight) node[pos=0.5] {\begin{tabular}{c}
			\scriptsize{Policy Network}
			\\
			$\mu_{i}(x)$
			\end{tabular}};  
		% Coords: K begin
		\xdef\xKbegin{\xacc} 
		% Coords: K bottom, top
		\xdef\yKbottom{\tmpy}   
		\xdef\yKtop{\fpeval{\tmpy + \bdboxheight}}  			
		% Label: K
		\xdef\tmpx{\fpeval{\xacc}}
		\xdef\tmpy{\fpeval{\tmpy+\bdboxlabeloffsety}}
		\put(\tmpx,\tmpy){\tiny{Policy Network}}      
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\bdboxwidth}}
		% Coords: K end
		\xdef\xKend{\xacc} 

		% ***********************
		%
		% K -> P
		%
		
		% Arrow: K -> P
		\xdef\yacc{\fpeval{0}}
		\draw [-latex] (\xacc,\yacc) to 
			coordinate [pos=0.25] (umid) 
			(\xacc+\uarrowlength,\yacc) 
			;
		%\put(\xacc,\yacc){\vector(1,0){\uarrowlength}}
		% Label: u
		\xdef\tmpx{\fpeval{\xacc+0.5*\uarrowlength}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$u$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\uarrowlength}}		            	

		% ***********************
		%
		% P
		%

		% Box: P
		\xdef\tmpy{\fpeval{\yacc-\bdboxheight/2}}
		\draw (\xacc,\tmpy) rectangle ++(\Pboxwidth,\bdboxheight) node[pos=0.5] {\begin{tabular}{c}
			\scriptsize{Nonlinear Environment}
			\\
			$\dot{x} = f(x) + g(x) u$
			\end{tabular}};         	
		% Coords: P top center
		\xdef\xPtop{\fpeval{\xacc+\Pboxwidth/2}}
		\xdef\yPtop{\fpeval{\yacc+\bdboxheight/2}}			
		% Label: P
		\xdef\tmpx{\fpeval{\xacc}}
		\xdef\tmpy{\fpeval{\tmpy+\bdboxlabeloffsety}}    
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\Pboxwidth}}
		% Coords: where y arrow begins
		\xdef\xyarrowbegin{\xacc}

		% ***********************
		%
		% P -> y
		%

		% Arrow: P -> y
		\xdef\yacc{\pathoffsety}
		\put(\xacc,\yacc){\vector(1,0){\yarrowlength}}
		% Coords: y end
		\xdef\xyend{\fpeval{\xacc + \yarrowlength}}
		% Label: y
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$y$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\yfblength}}		            

		% ***********************
		%
		% FEEDBACK: y
		%
				
		% Line: y -> downward portion of feedback path				
		\put(\xacc,\yacc){\line(0,-1){\feedbackpathheight}}
		% Update accumulators		
		\xdef\yacc{\fpeval{\yacc - \feedbackpathheight}}
		% Coord: y feedback bottom
		\xdef\yfbbottom{\yacc}			

		% Line: downward portion of y feedback path -> feedback path below e summer
		\xdef\tmpx{\fpeval{abs(\xacc-\xesum)}}				
		\put(\xacc,\yacc){\line(-1,0){\tmpx}}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc-\tmpx}}

		% Arrow: feedback path below e summer -> e summer
		\xdef\tmpy{\fpeval{abs(\yacc-\yesum) - \bdcirclediameter/2}}				
		\put(\xacc,\yacc){\vector(0,1){\tmpy}}

		% ***********************
		%
		% P -> x_r
		%
		
		% Line: P -> x_r
		\xdef\xacc{\xyarrowbegin}
		\xdef\yacc{\fpeval{-\pathoffsety}}
		\put(\xacc,\yacc){\line(1,0){\xrfblength}}
		% Label: x_r
		\xdef\tmpx{\fpeval{\xacc+\bdhorizlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$x_{r}$}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc+\xrfblength}}	

		% ***********************
		%
		% FEEDBACK: x_r
		%
		
		% Line: x_r -> downward portion of x_r feedback path				
		\put(\xacc,\yacc){\line(0,-1){\xrfeedbackpathheight}}
		% Update accumulators		
		\xdef\yacc{\fpeval{\yacc - \xrfeedbackpathheight}}	
		
		% Line: downward portion of x_r feedback path -> feedback path below entering K
		\xdef\tmpx{\fpeval{abs(\xacc-(\xKbegin-\xrfblength))}}				
		\put(\xacc,\yacc){\line(-1,0){\tmpx}}
		% Update accumulators
		\xdef\xacc{\fpeval{\xacc-\tmpx}}				

		% Line: feedback path below entering K -> feedback path up to entering K
		\xdef\tmpy{\fpeval{abs(\yacc-(-\pathoffsety))}}				
		\put(\xacc,\yacc){\line(0,1){\tmpy}}
		% Update accumulators
		\xdef\yacc{\fpeval{\yacc+\tmpy}}
		
		% Arrow: feedback path up to entering K -> K			
		\put(\xacc,\yacc){\vector(1,0){\xrfblength}}		

		% ***********************
		%
		% P -> INTEGRAL REINFORCEMENT
		%
		
		% Arrow: P -> int reinf
		\xdef\xacc{\xPtop}
		\xdef\yacc{\yPtop}
		\put(\xacc,\yacc){\vector(0,1){\bdarrowlengthup}}	
		% Label: x
		\xdef\tmpx{\fpeval{\xacc+\bdvertlabeloffsetx}}
		\xdef\tmpy{\fpeval{\yacc+\backgroundborderoverlap/3}}
		\put(\tmpx,\tmpy){$x$}	
		% Update accumulators
		\xdef\yacc{\fpeval{\yacc+\bdarrowlengthup}}	

		% ***********************
		%
		% INTEGRAL REINFORCEMENT
		%

		% Box: int reinf
		\xdef\tmpx{\fpeval{\xacc-\Pboxwidth/2}}
		\xdef\tmpy{\fpeval{\yacc}}
		\draw (\tmpx,\tmpy) rectangle ++(\Pboxwidth,\bdboxheight) node[pos=0.5] {\begin{tabular}{c}
				\scriptsize{Integral Reinforcement}
				\\
				$\int_{t_{k-1}}^{t_{k}} x^{T} Q x + \mu_{i}^{T} R \mu_{i} d\tau $
				\end{tabular}};  
		% Coords: int reinf top center
		\xdef\xintreinftop{\fpeval{\xacc}}
		\xdef\xintreinfleft{\fpeval{\tmpx}}
		\xdef\yintreinftop{\fpeval{\fpeval{\yacc+\bdboxheight}}}
		\xdef\yintreinfmid{\fpeval{\fpeval{\yacc+\bdboxheight/2}}}		        	
		% Coords: int reinf left center
		\xdef\xintreinfleft{\fpeval{\tmpx}}
		\xdef\yintreinfleft{\fpeval{\tmpy}}			 
		% Update accumulators
		\xdef\yacc{\fpeval{\yacc+\bdboxheight}}

		% ***********************
		%
		% INTEGRAL REINFORCEMENT -> RCI REGRESSION
		%
		
		% Arrow: int reinf -> RCI regression
		\put(\xacc,\yacc){\vector(0,1){\bdarrowlengthup}}	
		% Update accumulators
		\xdef\yacc{\fpeval{\yacc+\bdarrowlengthup}}	

		% ***********************
		%
		% RCI REGRESSION
		%

		% Box: int reinf -> RCI regression
		\xdef\tmpx{\fpeval{\xacc-\Pboxwidth/2}}
		\xdef\tmpy{\fpeval{\yacc}}
		\draw (\tmpx,\tmpy) rectangle ++(\Pboxwidth,\bdboxheight) node[pos=0.5] {\begin{tabular}{c}
				\scriptsize{RCI Learning Update}
				\\
				$\Theta_{i} c_{i} = \Xi_{i}$
				\end{tabular}}; 
		% Coords: RCI regression top center
		\xdef\xRCIregrtop{\fpeval{\xacc}}
		\xdef\yRCIregrtop{\fpeval{\fpeval{\yacc+\bdboxheight}}}		        			 
		% Update accumulators
		\xdef\yacc{\fpeval{\yacc+\bdboxheight/2}}

		% ***********************
		%
		% RCI REGRESSION -> CRITIC NN
		%
		
		% Arrow: RCI regression -> critic NN
		\xdef\tmpx{\fpeval{\xacc-\Pboxwidth/2}}
		\xdef\tmpy{\fpeval{\yacc}}	
		\xdef\tmplen{\fpeval{abs(\tmpx-\xKend)}}	
		\put(\tmpx,\tmpy){\vector(-1,0){\tmplen}}	
		% Label: c_i
		\xdef\tmpx{\fpeval{\tmpx-\tmplen/2}}
		\xdef\tmpy{\fpeval{\tmpy+\bdhorizlabeloffsety}}
		\put(\tmpx,\tmpy){$c_i$}		
		% Update accumulators
		\xdef\xacc{\fpeval{\tmpx-\tmplen}}	

		% ***********************
		%
		% CRITIC NN
		%
		
		% Box: V
		\xdef\tmpx{\fpeval{\xKbegin}}
		\xdef\tmpy{\fpeval{\yacc-\bdboxheight/2}}
		\draw (\tmpx,\tmpy) rectangle ++(\bdboxwidth,\bdboxheight) node[pos=0.5] {\begin{tabular}{c}
			\scriptsize{Value Network}
			\\
			$V(x)$
			\end{tabular}}; 
		% Coordinate: V bottom ceneter
		\xdef\yVbottom{\tmpy} 
		\xdef\xVcenter{\fpeval{\xKbegin+\bdboxwidth/2}}   			

		% ***********************
		%
		% CRITIC NN -> POLICY NN
		%
		
		% Line: critic NN -> above policy NN
		\xdef\xacc{\fpeval{\xVcenter}}
		\xdef\yacc{\fpeval{\yVbottom}}	
		\xdef\tmplen{\fpeval{abs(\yacc-\yKtop) * 0.6}}
		\draw [-latex] (\xacc,\yacc) 
			to ++(0,-\tmplen) 
			to ([shift={(1,-\backgroundborderoverlap*3/4)}]KSW)
			;
			

		% ***********************
		%
		% u -> INTEGRAL REINFORCEMENT
		%
		
		% Arrow: u -> int reinf 
		\draw [-latex] (umid) |- (\xintreinfleft,\yintreinfmid);
	

		% ***********************
		%
		% RCI LEARNING LOOP
		%
		
		% RCI learning loop rectangle		
		\xdef\backgroundwidth{\fpeval{abs(\xyend - \xrstart) + 2*\backgroundborder}}		
		\xdef\backgroundlearningheight{\fpeval{abs(\yRCIregrtop - \yKtop)} + \backgroundborder-\backgroundborderoverlap}	
		\draw [dashed, fill=blue, fill opacity=0.15] (\xrstart-\backgroundborder,\yKtop+\backgroundborderoverlap) 
			coordinate (backgroundlearningSW)
			rectangle ++(\backgroundwidth,\backgroundlearningheight)
			coordinate (backgroundlearningNE)
			;
		% Coord: NW corner of RCI learning loop rectangle
		\coordinate (backgroundlearningNW) at (backgroundlearningSW |- backgroundlearningNE);
		% Coord: SE corner of RCI learning loop rectangle
		\coordinate (backgroundlearningSE) at (backgroundlearningNE |- backgroundlearningSW);
		% Label: RCI learning loop
		\draw [right] node at ([shift={(0.5,-1)}]backgroundlearningNW) {RCI Learning Loop};


		% ***********************
		%
		% RCI FEEDBACK LOOP
		%
		
		% RCI feedback loop rectangle				
		\xdef\backgroundfbheight{\fpeval{abs(\yKbottom - \yfbbottom) + \backgroundborder-\backgroundborderoverlap}}	
		\draw [dashed, fill=yellow, fill opacity=0.15] (\xrstart-\backgroundborder,\yKbottom-\backgroundborderoverlap) 
			coordinate (backgroundfbNW)
			rectangle ++(\backgroundwidth,-\backgroundfbheight)
			coordinate (backgroundfbSE)
			;
		% Coord: SW corner of RCI feedback loop rectangle
		\coordinate (backgroundfbSW) at (backgroundfbNW |- backgroundfbSE);
		% Coord: NE corner of RCI feedback loop rectangle
		\coordinate (backgroundfbNE) at (backgroundfbSE |- backgroundfbNW);
		% Label: RCI feedback loop
		\draw [right] node at ([shift={(0.5,1)}]backgroundfbSW) {RCI Feedback Loop};

		% ***********************
		%
		% REGION BETWEEN RCI LEARNING LOOP AND FEEDBACK LOOP
		%		
		
		% Dashed lines to connect the vertical outlines of the loops
		\draw [dashed] (backgroundlearningSW) -- (backgroundfbNW);
		\draw [dashed] (backgroundlearningSE) -- (backgroundfbNE);
		% Fill in region
		\xdef\backgroundoverlapheight{\fpeval{abs((\yKtop+\backgroundborderoverlap) - (\yKbottom-\backgroundborderoverlap))}}
		\fill [fill=green, fill opacity=0.15] (backgroundfbNW) rectangle ++(\backgroundwidth,\backgroundoverlapheight);
		
		\end{tikzpicture}
		\vspace{0.5in}
		\caption{RCI block diagram.}
		%\label{fig:}
\end{figure} 


